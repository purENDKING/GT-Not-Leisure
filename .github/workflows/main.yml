name: Auto-close untagged issues

on:
  issues:
    types: [opened, edited]

jobs:
  check_and_close_untagged_issues:
    runs-on: ubuntu-latest steps:
      - name: Check if issue has labels id: check_labels uses: actions/github-script@v6 with:
          script: |
            const issue = context.payload.issue if (issue.labels.length === 0) {
              core.setOutput('has_labels', 'false')
 } else {
              core.setOutput('has_labels', 'true')
            }
      - name: Close untagged issue if: steps.check_labels.outputs.has_labels == 'false'
        uses: actions/github-script@v6 with:
          script: |
            const issue = context.payload.issue
            await github.rest.issues.update({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: issue.number,
              state: 'closed'
            })
            await github.rest.issues.createComment({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: issue.number,
              body: `@${issue.user.login} æ‚¨å¥½ï¼ğŸ‘‹\n\nè¿™ä¸ª issue å› ä¸ºæ²¡æœ‰æ·»åŠ ä»»ä½•æ ‡ç­¾è€Œè¢«è‡ªåŠ¨å…³é—­ã€‚è¯·åˆ›å»ºä¸€ä¸ªå¸¦æœ‰é€‚å½“æ ‡ç­¾çš„æ–° issueã€‚`
            })
